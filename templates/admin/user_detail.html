{% extends "admin/base.html" %}

{% block title %}ุชูุงุตูู {{ user.name }}{% endblock %}

{% block content %}
<div class="page-header">
    <h1>๐ค ุชูุงุตูู ุงููุณุชุฎุฏู</h1>
    <div class="breadcrumb">
        <a href="/admin/users" style="color: var(--primary-teal); text-decoration: none;">ุงููุณุชุฎุฏููู</a> / {{ user.name
        }}
    </div>
</div>

{% if success_message %}
<div class="alert alert-success">
    <span>โ</span>
    {{ success_message }}
</div>
{% endif %}

{% if error_message %}
<div class="alert alert-error">
    <span>โ</span>
    {{ error_message }}
</div>
{% endif %}

<div style="display: grid; grid-template-columns: 1fr 2fr; gap: 25px;">
    <!-- User Profile Card -->
    <div class="card" style="text-align: center;">
        <div
            style="width: 100px; height: 100px; background: {% if user.is_paid %}var(--gold-accent){% else %}var(--primary-teal){% endif %}; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; font-size: 40px; color: white; font-weight: bold;">
            {{ user.name[0] }}
        </div>

        <h2 style="color: var(--dark-teal); margin-bottom: 5px;">{{ user.name }}</h2>
        <p style="color: var(--gray); direction: ltr; margin-bottom: 20px;">{{ user.phone }}</p>

        {% if user.is_paid %}
        <div
            style="background: linear-gradient(135deg, var(--gold-accent), #9a7d4a); color: white; padding: 12px 25px; border-radius: 25px; display: inline-block; font-weight: bold;">
            ๐ ูุดุชุฑู
        </div>
        {% else %}
        <div
            style="background: var(--gray-light); color: var(--gray); padding: 12px 25px; border-radius: 25px; display: inline-block; font-weight: bold;">
            ๐ค ุบูุฑ ูุดุชุฑู
        </div>
        {% endif %}

        <div style="margin-top: 25px; padding-top: 20px; border-top: 1px solid #eee;">
            <div style="display: flex; justify-content: space-between; padding: 8px 0;">
                <span style="color: var(--gray);">๐ ุชุงุฑูุฎ ุงูุชุณุฌูู</span>
                <span style="font-weight: 600;">{{ user.created_at[:10] }}</span>
            </div>
            <div style="display: flex; justify-content: space-between; padding: 8px 0;">
                <span style="color: var(--gray);">๐ ุฑูู ุงููุณุชุฎุฏู</span>
                <span style="font-weight: 600;">#{{ user.id }}</span>
            </div>
            {% if user.fcm_token %}
            <div style="display: flex; justify-content: space-between; padding: 8px 0;">
                <span style="color: var(--gray);">๐ฑ ุงูุฅุดุนุงุฑุงุช</span>
                <span class="badge badge-success">ููุนููุฉ</span>
            </div>
            {% else %}
            <div style="display: flex; justify-content: space-between; padding: 8px 0;">
                <span style="color: var(--gray);">๐ฑ ุงูุฅุดุนุงุฑุงุช</span>
                <span class="badge badge-warning">ุบูุฑ ููุนููุฉ</span>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Actions Card -->
    <div>
        <!-- Change Subscription Status -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">๐ณ ุฅุฏุงุฑุฉ ุงูุงุดุชุฑุงู</h2>
            </div>

            <p style="color: var(--gray); margin-bottom: 20px;">
                ุงูุญุงูุฉ ุงูุญุงููุฉ:
                {% if user.is_paid %}
                <strong style="color: var(--gold-accent);">ูุดุชุฑู โ</strong>
                {% else %}
                <strong style="color: var(--gray);">ุบูุฑ ูุดุชุฑู โ</strong>
                {% endif %}
            </p>

            {% if user.is_paid %}
            <form method="POST" action="/admin/users/{{ user.id }}/unpaid">
                <button type="submit" class="btn" style="background: var(--orange); color: white; width: 100%;"
                    onclick="return confirm('ูู ุชุฑูุฏ ุฅูุบุงุก ุงุดุชุฑุงู {{ user.name }}ุ')">
                    โ ุฅูุบุงุก ุงูุงุดุชุฑุงู (ุชุญููู ูุบูุฑ ูุดุชุฑู)
                </button>
            </form>
            {% else %}
            <form method="POST" action="/admin/users/{{ user.id }}/paid">
                <button type="submit" class="btn btn-gold" style="width: 100%;"
                    onclick="return confirm('ูู ุชุฑูุฏ ุชูุนูู ุงุดุชุฑุงู {{ user.name }}ุ')">
                    โ ุชูุนูู ุงูุงุดุชุฑุงู (ุชุญููู ููุดุชุฑู)
                </button>
            </form>
            {% endif %}
        </div>

        <!-- Send Notification -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">๐ ุฅุฑุณุงู ุฅุดุนุงุฑ ุฎุงุต</h2>
            </div>

            <form method="POST" action="/admin/notifications/send">
                <input type="hidden" name="target_type" value="specific">
                <input type="hidden" name="target_user_id" value="{{ user.id }}">

                <div class="form-group">
                    <label class="form-label">ูุต ุงูุฅุดุนุงุฑ</label>
                    <textarea name="text" class="form-control" placeholder="ุงูุชุจ ุฑุณุงูุชู ูู {{ user.name }}..."
                        required></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">ุฑุงุจุท ุตูุฑุฉ (ุงุฎุชูุงุฑู)</label>
                    <input type="url" name="image_url" class="form-control" placeholder="https://example.com/image.jpg">
                </div>

                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    ๐ ุฅุฑุณุงู ุงูุฅุดุนุงุฑ ูู {{ user.name }}
                </button>
            </form>
        </div>

        <!-- Delete User -->
        <div class="card" style="border: 2px solid var(--red-accent);">
            <div class="card-header">
                <h2 class="card-title" style="color: var(--red-accent);">๐๏ธ ุญุฐู ุงููุณุชุฎุฏู</h2>
            </div>

            <p style="color: var(--gray); margin-bottom: 20px;">
                โ๏ธ ุชุญุฐูุฑ: ุญุฐู ุงููุณุชุฎุฏู ููุงุฆู ููุง ูููู ุงูุชุฑุงุฌุน ุนูู!
            </p>

            <form method="POST" action="/admin/users/{{ user.id }}/delete">
                <button type="submit" class="btn btn-danger" style="width: 100%;"
                    onclick="return confirm('โ๏ธ ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู {{ user.name }}ุ\n\nูุฐุง ุงูุฅุฌุฑุงุก ููุงุฆู ููุง ูููู ุงูุชุฑุงุฌุน ุนูู!')">
                    ๐๏ธ ุญุฐู ุงููุณุชุฎุฏู ููุงุฆูุงู
                </button>
            </form>
        </div>
    </div>
</div>

<div style="margin-top: 20px;">
    <a href="/admin/users" class="btn btn-outline">โ ุงูุนูุฏุฉ ูููุณุชุฎุฏููู</a>
</div>
{% endblock %}