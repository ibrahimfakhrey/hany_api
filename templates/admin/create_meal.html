{% extends "admin/base.html" %}

{% block title %}إضافة وجبة{% endblock %}

{% block content %}
<div class="page-header">
    <h1>➕ إضافة وجبة جديدة</h1>
    <p class="breadcrumb">لوحة التحكم / الوجبات / إضافة وجبة</p>
</div>

{% if success_message %}
<div class="alert alert-success">
    {{ success_message }}
</div>
{% endif %}

{% if error_message %}
<div class="alert alert-error">
    {{ error_message }}
</div>
{% endif %}

<div class="card">
    <div class="card-header">
        <span class="card-title">بيانات الوجبة</span>
        <a href="{{ url_for('admin.meals_list') }}" class="btn btn-outline">
            ↩️ العودة للقائمة
        </a>
    </div>

    <form action="{{ url_for('admin.create_meal') }}" method="POST" enctype="multipart/form-data">
        <div class="form-group">
            <label class="form-label">عنوان الوجبة *</label>
            <input type="text" name="title" class="form-control" placeholder="مثال: سلطة الدجاج المشوي" required>
        </div>

        <div class="form-group">
            <label class="form-label">الوصف</label>
            <textarea name="description" class="form-control" placeholder="وصف الوجبة، المكونات، السعرات الحرارية..."></textarea>
        </div>

        <div class="form-group">
            <label class="form-label">رابط الوصفة</label>
            <input type="url" name="link" class="form-control" placeholder="https://..." dir="ltr">
        </div>

        <div class="form-group">
            <label class="form-label">صورة الوجبة</label>
            <input type="file" name="image" class="form-control" accept="image/*" onchange="previewImage(this)">
            <img id="imagePreview" style="max-width: 300px; margin-top: 15px; border-radius: 10px; display: none;">
        </div>

        <div style="margin-top: 30px; display: flex; gap: 15px;">
            <button type="submit" class="btn btn-primary" style="flex: 1;">
                ✅ إضافة الوجبة
            </button>
            <a href="{{ url_for('admin.meals_list') }}" class="btn btn-outline">
                ❌ إلغاء
            </a>
        </div>
    </form>
</div>

<script>
function previewImage(input) {
    const preview = document.getElementById('imagePreview');
    if (input.files && input.files[0]) {
        const reader = new FileReader();
        reader.onload = function(e) {
            preview.src = e.target.result;
            preview.style.display = 'block';
        };
        reader.readAsDataURL(input.files[0]);
    } else {
        preview.style.display = 'none';
    }
}
</script>
{% endblock %}
